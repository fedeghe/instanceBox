instanceBox=function(){"use strict";function unpack(fr,key){var f=eval("("+fr.constructor+")"),o=new f,i,j=0,fn=eval(fr.constructorName),proto=new fn;Object.setPrototypeOf(o,proto);for(i in fr.props)o[i].constructor.name.match(/boolean|number|date|string|object|array/i)?o[i]=tools.encoder.decode(fr.props[i]):o[i]=store.getItem(key+"_"+j++);for(i in fr.proto)f.prototype[i]=eval("("+fr.proto[i]+")");return o}function pack(e,t){var r,o=e.constructor.prototype,n={},a={},s=0;try{for(r in e)e.hasOwnProperty(r)&&(e[r].constructor.name.match(/boolean|number|date|string|object|array/i)?(console.log("hit: ",e[r].constructor.name),n[r]=tools.encoder.encode(e[r])):(console.log("missed: ",e[r]),n[r]=store.setItem(t+"_"+s++,e[r])));for(r in o)a[r]=o[r].toString()}catch(e){return!1}return{constructor:e.constructor.toString(),constructorName:e.constructor.name,props:n,proto:a}}function getKey(e){return"iB-"+e}var storage=localStorage,tools={encoder:{encode:function(e){switch(typeof e){case"string":return{nature:"string",val:e};case"number":return{nature:"number",val:e};case"boolean":return{nature:"boolean",val:e};case"function":return{nature:"function",val:e.toString()};case"object":return{nature:"object",val:JSON.stringify(e)};case null:default:return null}},decode:function(el){switch(el.nature){case"string":case"number":case"boolean":return el.val;case"function":return eval("("+el.val+")");case"object":return JSON.parse(el.val);case null:default:return null}}},base64:{forth:function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))},back:function(e){return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}}},store={base64:!0,setItem:function(e,t){var r=JSON.stringify(pack(t,e)),o=getKey(e);store.base64&&(r=tools.base64.forth(r));try{storage.setItem(o,r),store.setSize(o,r)}catch(e){return e}return!0},getItem:function(e){var t=storage.getItem(getKey(e)),r=null;return t&&(store.base64&&(t=tools.base64.back(t,e)),r=unpack(JSON.parse(t))),r},setSize:function(e,t){return storage.setItem(e+"---size",t.length)},getSize:function(e){var t=storage.getItem(getKey(e)+"---size");return null!==t?+t:null},key:function(e){var t=storage.key(e);return t=t.replace(/$iB-/,"")},removeItem:function(e){storage.removeItem(e)},clear:function(){storage.clear()},length:function(){return storage.length},useLocalStorage:function(){storage=localStorage},useSessionStorage:function(){storage=sessionStorage}};return{base64:function(e){store.base64=!!e},useLocalStorage:store.useLocalStorage,useSessionStorage:store.useSessionStorage,set:store.setItem,get:store.getItem,remove:store.removeItem,clear:store.clear,length:store.length,getSize:store.getSize}}();